<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>advance-js</title>
	<link rel="stylesheet" type="text/css" href="css/animation.css">
	<script type="text/javascript" src = "https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script type = "text/javascript" rel = "stylesheet" src = "js/swipe.js"></script>
	<script type = "text/javascript" rel = "stylesheet" src = "js/animation.js"></script>
</head>
<body>
	<div class="content">
		<ul class="wrap">
			<li class="itme1">
				<!-- <h1>content1</h1> -->
				<div class="a_background">
					<div class="a_background_top"></div>
					<div class="a_background_middle"></div>
					<div class="a_background_botton"></div>
				</div>
				<div class="sun rotation"></div>
				<div class="cloudArea">
					<div class="cloud cloud1 cloud1Anim"></div>
					<div class="cloud cloud2 cloud2Anim"></div>
				</div>
			</li>
			<li class="itme2">
				<!-- 背景 -->
				<div class="b_background"></div>
				<div class="b_background_pre"></div>
				<!-- 商店 -->
				<div class="shop">
					<div class="door">
						<div class="door_left"></div>
						<div class="door_right"></div>
					</div>
					<!-- 灯 -->
					<div class="lamp"></div>
				</div>
				<!-- 鸟 -->
				<div class="bird birdfly"></div>
				
				
			</li>
			<li class="itme3">
				<!-- 背景图 -->
				<div class="c_background">
					<div class="c_background_top"></div>
					<div class="c_background_middle"></div>
					<div class="c_background_bottom"></div>

				</div>
				<!-- 小女孩 -->
				<div class="girl"></div>
				<!-- 水波 -->
				<div class="bridge-bottom">
					<div class="water">
						<div class="water1"></div>
						<div class="water2"></div>
						<div class="water3"></div>
						<div class="water4"></div>
					</div>
				</div>
				<!-- 星星 -->
				<ul class="stars">
					<li class="stars1"></li>
					<li class="stars2"></li>
					<li class="stars3"></li>
					<li class="stars4"></li>
					<li class="stars5"></li>
					<li class="stars6"></li>
				</ul>
			</li>
		</ul>
		<div id="boy" class="charactor"></div>
	</div>
</body>
<script>
$(function(){


		var container = $('.content');
		var swipe = Swipe(container);
		var boy = boywalk();
		//--------------测试then函数---------------------------
		// boy.walkTo(2000,0.2).then(function(){
		// 	boy.setColor('#ccc');
		// 	}).then(function(){
		// 		return boy.walkTo(4000,0.4);     //这里为什么要return出去  如果不使用它 则会影响后面的setcolor函数
		// 	}).then(function(){
		// 	boy.setColor('#333');
		// 	}).then(function(){
		// 		return boy.walkTo(18000,0.8);
		// 	}).then(function(){
		// 	boy.setColor('pink');
		// 	});

      function scrollTo(time,proportionX){
      		var distX = container.width()*proportionX;
      		swipe.scrollTo(distX,time);
      }



//开关灯的变化：
     var lamp = {
			elem  : $('.b_background'),
			bright:function(){
				
				this.elem.addClass('lamp_bright');
				console.log(this);

			},
			dark :function(){
				this.elem.removeClass('lamp_bright');
			}
	};
//第二幅画面的飞鸟的动画
  var bird = {
  	elem :$('.bird'),
  	fly:function(){
  		this.elem.addClass('birdfly');
  		this.elem.animate({
  			right:container.width(),
  		},15000,'linear');
  	}
  };

// var girl = {
// 	elem : $('.girl'),
// 	getHeight:function(){
// 		return this.elem.height();
// 	},
// 	// 转身动作
// 	rotate:function(){
// 		this.elem.addClass('girl-rotate');
// 	},
// 	setoffset:function(){
// 		this.elem.css({
// 			left:visualWidth/2,
// 			top:bridge-this.getHeight()
// 		});
// 	},
// 	getoffset:function(){
// 		return this.elem.offset();
// 	},
// 	getwidth:function(){
// 		return this.elem.width();
// 	}


// };
// // 修正小女孩的位置
//   girl.setoffset();








      boy.walkTo(2000,0.2) //行走2S 
      .then(function(){
      	scrollTo(10000,1);  //背景开始运动1个屏幕的距离花时10S
      }).then(function(){
      	return boy.walkTo(10000,0.5); //男孩继续走 距离花时10S
      }).then(function(){
      	 boy.stopwalk();   //暂停走路，
      }).then(function(){
      	return opendoor(); //开门
      }).then(function(){
      		lamp.bright();  //开灯；
      }).then(function(){
      	return boy.toshop(2000); //进入商店
      }).then(function(){
      	return boy.takeflower();  //取花
      }).then(function(){
      	bird.fly();          //飞鸟
      }).then(function(){
      	return boy.outshop();
      }).then(function(){
      	return shutdoor();
      }).then(function(){
      	lamp.dark();
      }).then(function(){
      	boy.walkTo(5000,.12)
      }).then(function(){
      	scrollTo(10000,2);  //背景开始运动1个屏幕的距离花时10S
      });
      


      // opendoor().then(function(){
      // 	lamp.bright();

      // });
    

});  //-------domready结束---------			
</script>
</html>